# Excalidraw åæ ‡é—®é¢˜ç®€æ˜“ä¿®å¤æŒ‡å—

## âœ… å·²åº”ç”¨çš„ä¿®å¤

### 1. ç®€åŒ–å®¹å™¨ç»“æ„
- âŒ ç§»é™¤äº†å¤æ‚çš„åŒå±‚å®¹å™¨
- âœ… ä½¿ç”¨å•ä¸€ç®€æ´çš„å®¹å™¨
- âœ… ä½¿ç”¨ `outline` ä»£æ›¿ `border`ï¼ˆoutline ä¸å ç”¨ç©ºé—´ï¼‰

### 2. æ”¹è¿›æ•°æ®åŒæ­¥
- âœ… ç§»é™¤ `isInitializedRef`
- âœ… ä½¿ç”¨ `lastLoadedDataRef` è·Ÿè¸ªå·²åŠ è½½æ•°æ®
- âœ… å“åº” `initialData` çš„å˜åŒ–
- âœ… æ·»åŠ  `key` prop å¼ºåˆ¶é‡æ–°æŒ‚è½½

## ğŸ§ª å¿«é€Ÿæµ‹è¯•æ­¥éª¤

### æµ‹è¯• 1: åŸºæœ¬ç»˜åˆ¶ï¼ˆ30ç§’ï¼‰

1. **åˆ·æ–°æµè§ˆå™¨**ï¼ˆé‡è¦ï¼æŒ‰ F5 æˆ– Cmd+Rï¼‰
2. **æ£€æŸ¥æµè§ˆå™¨ç¼©æ”¾**
   - æŒ‰ `Ctrl+0` (Windows) æˆ– `Cmd+0` (Mac)
   - ç¡®ä¿ç¼©æ”¾ä¸º 100%
3. **æ‰“å¼€ Session åˆ›å»ºå¯¹è¯æ¡†**
4. **åˆ‡æ¢åˆ°"ç”»å›¾ Whiteboard"**
5. **æµ‹è¯•ç‚¹å‡»**:
   - ç‚¹å‡»ä¸€ä¸ªç‚¹
   - åº”è¯¥æ­£å¥½åœ¨é¼ æ ‡ä½ç½®
6. **æµ‹è¯•æ‹–æ‹½**:
   - é€‰æ‹©çŸ©å½¢å·¥å…·
   - æ‹–æ‹½ç»˜åˆ¶çŸ©å½¢
   - èµ·ç‚¹å’Œç»ˆç‚¹åº”è¯¥å‡†ç¡®

### æµ‹è¯• 2: å…¨å±åŒæ­¥ï¼ˆ1åˆ†é’Ÿï¼‰

1. **ç‚¹å‡»"å…¨å±ç¼–è¾‘"**
2. **ç”»å‡ ä¸ªå›¾å½¢**
3. **æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°**ï¼ˆF12ï¼‰
4. **ç‚¹å‡»"å®Œæˆ Done"**
5. **æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º**:
   ```
   ğŸ” Save clicked, data length: XXX
   ğŸ”„ Loaded Excalidraw data: {elementsCount: X}
   ```
6. **æ£€æŸ¥å°çª—å£**:
   - åº”è¯¥æ˜¾ç¤ºåˆšæ‰ç”»çš„å†…å®¹
   - æ•°æ®å¤§å°åº”è¯¥æ˜¾ç¤ºæ­£ç¡®çš„ bytes

## ğŸ› å¦‚æœè¿˜æœ‰åæ ‡åç§»

### å¯èƒ½çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆ

#### åŸå›  1: æµè§ˆå™¨ç¼©æ”¾
**æ£€æŸ¥æ–¹æ³•**:
- çœ‹æµè§ˆå™¨åœ°å€æ å³ä¾§æ˜¯å¦æ˜¾ç¤ºç¼©æ”¾ç™¾åˆ†æ¯”
- æˆ–è€…æŒ‰ `Ctrl+0` / `Cmd+0` é‡ç½®

**ç—‡çŠ¶**:
- åç§»é‡éšç¼©æ”¾æ¯”ä¾‹å˜åŒ–
- ä¾‹å¦‚ 110% ç¼©æ”¾æ—¶åç§»çº¦ 10% è·ç¦»

#### åŸå›  2: æµè§ˆå™¨æ‰©å±•å¹²æ‰°
**æ£€æŸ¥æ–¹æ³•**:
- æ‰“å¼€éšç§/æ— ç—•æ¨¡å¼æµ‹è¯•
- æˆ–è€…ç¦ç”¨æ‰€æœ‰æµè§ˆå™¨æ‰©å±•

**å¯èƒ½å¹²æ‰°çš„æ‰©å±•**:
- é¼ æ ‡æ‰‹åŠ¿
- é¡µé¢ç¼©æ”¾å·¥å…·
- æˆªå›¾å·¥å…·
- é¢œè‰²é€‰æ‹©å™¨

#### åŸå›  3: æ“ä½œç³»ç»Ÿæ˜¾ç¤ºç¼©æ”¾
**æ£€æŸ¥æ–¹æ³•**:
- Windows: è®¾ç½® â†’ æ˜¾ç¤º â†’ ç¼©æ”¾å’Œå¸ƒå±€ â†’ åº”è¯¥æ˜¯ 100%
- Mac: ç³»ç»Ÿåå¥½è®¾ç½® â†’ æ˜¾ç¤ºå™¨ â†’ åˆ†è¾¨ç‡ â†’ é»˜è®¤

#### åŸå›  4: çˆ¶å®¹å™¨æœ‰ transform
**æ£€æŸ¥æ–¹æ³•**:
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. æ£€æŸ¥å…ƒç´ ï¼ˆå³é”®ç‚¹å‡»ç”»å¸ƒ â†’ æ£€æŸ¥ï¼‰
3. æŸ¥çœ‹ Computed æ ·å¼
4. æœç´¢ `transform`
5. å¦‚æœæœ‰ä»»ä½• transformï¼ˆé™¤äº† `none`ï¼‰ï¼Œé‚£å°±æ˜¯é—®é¢˜

**ä¸´æ—¶è§£å†³**:
åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œï¼š
```javascript
// æŸ¥æ‰¾å¹¶ç§»é™¤ transform
document.querySelectorAll('[style*="transform"]').forEach(el => {
  el.style.transform = 'none';
});
```

## ğŸ“ æ‰‹åŠ¨æµ‹è¯•åæ ‡

åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œæ­¤ä»£ç æ¥æµ‹è¯•åæ ‡ï¼š

```javascript
// 1. æ‰¾åˆ° Excalidraw å®¹å™¨
const container = document.querySelector('[style*="height"]');
console.log('Container:', container);

// 2. è·å–è¾¹ç•Œä¿¡æ¯
const rect = container.getBoundingClientRect();
console.log('Boundary:', {
  top: rect.top,
  left: rect.left,
  width: rect.width,
  height: rect.height,
});

// 3. æ£€æŸ¥æ ·å¼
const style = window.getComputedStyle(container);
console.log('Styles:', {
  border: style.border,
  padding: style.padding,
  margin: style.margin,
  transform: style.transform,
  position: style.position,
});

// 4. ç‚¹å‡»ç›‘å¬æµ‹è¯•
container.addEventListener('click', (e) => {
  console.log('Click at:', {
    clientX: e.clientX,
    clientY: e.clientY,
    offsetX: e.offsetX,
    offsetY: e.offsetY,
    layerX: e.layerX,
    layerY: e.layerY,
  });
}, { once: true });
console.log('Click the canvas to see coordinates...');
```

## ğŸ”§ å¦‚æœæ•°æ®ä¸åŒæ­¥

### æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—

**åº”è¯¥çœ‹åˆ°çš„å®Œæ•´æµç¨‹**:
```bash
# 1. æ‰“å¼€å…¨å±
ğŸ” SessionDialog - fullscreenMode changed: whiteboard

# 2. åœ¨å…¨å±ç”»å›¾
ğŸ” Fullscreen onChange, data length: 450
ğŸ¨ Excalidraw data changed: {elementsCount: 1, dataSize: 450}

# 3. ç»§ç»­ç”»
ğŸ” Fullscreen onChange, data length: 850
ğŸ¨ Excalidraw data changed: {elementsCount: 2, dataSize: 850}

# 4. ç‚¹å‡»å®Œæˆ
ğŸ” Save clicked, data length: 850
ğŸ” Closing fullscreen, current data length: 850
ğŸ” SessionDialog - fullscreenMode changed: null

# 5. å°çª—å£é‡æ–°åŠ è½½ï¼ˆå…³é”®ï¼ï¼‰
ğŸ”„ Loaded Excalidraw data: {elementsCount: 2, dataSize: 850}

# 6. åœ¨å°çª—å£ç»§ç»­ç¼–è¾‘
ğŸ” Small onChange, data length: 1200
```

### å¦‚æœç¼ºå°‘æŸä¸ªæ­¥éª¤

**ç¼ºå°‘ "Fullscreen onChange"**:
- å…¨å±æ¨¡å¼çš„ onChange æ²¡è§¦å‘
- Excalidraw å¯èƒ½æ²¡æœ‰æ­£ç¡®åˆå§‹åŒ–

**ç¼ºå°‘ "Loaded Excalidraw data"**:
- å°çª—å£æ²¡æœ‰é‡æ–°åŠ è½½æ•°æ®
- æ£€æŸ¥ `key` prop æ˜¯å¦ç”Ÿæ•ˆ
- æ£€æŸ¥ `initialData` æ˜¯å¦æ”¹å˜

**ç¼ºå°‘ "Small onChange"**:
- å°çª—å£çš„ onChange æ²¡è§¦å‘
- å¯èƒ½æ˜¯ç»„ä»¶æ²¡æœ‰æ­£ç¡®æŒ‚è½½

## ğŸš‘ ç´§æ€¥ä¿®å¤

å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œï¼Œå°è¯•è¿™ä¸ªä¸´æ—¶æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆ A: åªç”¨å…¨å±æ¨¡å¼
æš‚æ—¶éšè—å°çª—å£çš„ç”»å›¾ï¼Œåªä½¿ç”¨å…¨å±æ¨¡å¼ï¼š

1. æ‰“å¼€ SessionDialog
2. åˆ‡æ¢åˆ°"ç”»å›¾"æ ‡ç­¾
3. ç›´æ¥ç‚¹å‡»"å…¨å±ç¼–è¾‘"
4. åœ¨å…¨å±å®Œæˆæ‰€æœ‰ç»˜åˆ¶
5. ç‚¹å‡»"å®Œæˆ"åç›´æ¥ä¿å­˜ Session

### æ–¹æ¡ˆ B: æˆªå›¾è®°å½•
å¦‚æœç»˜å›¾åŠŸèƒ½å®Œå…¨ä¸å¯ç”¨ï¼š

1. ä½¿ç”¨å…¶ä»–ç»˜å›¾å·¥å…·ï¼ˆå¦‚ç³»ç»Ÿæˆªå›¾å·¥å…·ï¼‰
2. å°†å›¾ç‰‡ä¿å­˜å¹¶ä¸Šä¼ åˆ°å…¶ä»–åœ°æ–¹
3. åœ¨ç¬”è®°ä¸­æ·»åŠ å›¾ç‰‡é“¾æ¥

## ğŸ“ æä¾›åé¦ˆä¿¡æ¯

å¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **æµè§ˆå™¨ä¿¡æ¯**:
   - æµè§ˆå™¨åç§°å’Œç‰ˆæœ¬
   - æ“ä½œç³»ç»Ÿ

2. **åç§»æƒ…å†µ**:
   - åç§»æ–¹å‘ï¼ˆå³ä¸‹ï¼Ÿå·¦ä¸Šï¼Ÿï¼‰
   - å¤§çº¦åç§»å¤šå°‘åƒç´ ï¼Ÿ
   - æ˜¯å›ºå®šåç§»è¿˜æ˜¯éšä½ç½®å˜åŒ–ï¼Ÿ

3. **æ§åˆ¶å°æ—¥å¿—**:
   - å¤åˆ¶æ‰€æœ‰ ğŸ” å’Œ ğŸ¨ å¼€å¤´çš„æ—¥å¿—

4. **å±å¹•å½•åˆ¶**:
   - å¦‚æœå¯èƒ½ï¼Œå½•åˆ¶ä¸€ä¸ªçŸ­è§†é¢‘å±•ç¤ºé—®é¢˜

---

**Updated**: 2024-10-10
**Version**: 3.0 (ç®€åŒ–ç‰ˆ)

